# %%
import numpy as np
from numpy import *
import matplotlib.pyplot as plt

# %%
def integrate_gauss_quad_segment(function, x1,y1,x2,y2):
    x_root = [-0.906179845938664,
                -0.5384693101056831 ,
                0.0,
                0.5384693101056831,
                0.906179845938664 ]
    weight = [0.2369268850561891,
                0.47862867049936647,
              0.5688888888888889,
              0.47862867049936647,
                0.2369268850561891 ]
    sum = 0
    dai = np.linalg.norm([x1-x2,y1-y2])
    for i in range(0,5):
        ti_le = (x_root[i]+1)/2
        x = x1* (1-ti_le) + x2 * ti_le
        y = y1* (1-ti_le) + y2 * ti_le
        sum +=  dai * function(x,y) *weight[i]*0.5
    return sum

# %%
def det(x_val,y_val,x1,y1,x2,y2):
    return (x1-x_val)*(y2-y_val) - (x2-x_val)*(y1-y_val)

# %%
def integrate_gauss_quad_triangle(function, x1,y1,x2,y2,x3,y3):
    x_quad = np.zeros((14,2))

    x_quad[0]=[6.943184420297371E-002,       4.365302387072518E-002]
    x_quad[1]=[6.943184420297371E-002,      0.214742881469342]
    x_quad[2]= [6.943184420297371E-002,        0.465284077898513]
    x_quad[3]=[6.943184420297371E-002,     0.715825274327684]
    x_quad[4]=[6.943184420297371E-002,       0.886915131926301]
    x_quad[5]=[0.330009478207572,         4.651867752656094E-002]
    x_quad[6]=[0.330009478207572,         0.221103222500738]
    x_quad[7] = [0.330009478207572,        0.448887299291690      ]
    x_quad[8] = [0.330009478207572,        0.623471844265867]
    x_quad[9] =[0.669990521792428,        3.719261778493340E-002]
    x_quad[10]=[0.669990521792428,        0.165004739103786]
    x_quad[11]=[0.669990521792428,        0.292816860422638]
    x_quad[12]=[0.930568155797026,        1.467267513102734E-002]
    x_quad[13]=[0.930568155797026,       5.475916907194637E-002]
    weight_quad = [ 1.917346464706755E-002,
                3.873334126144628E-002,
                4.603770904527855E-002,
                3.873334126144628E-002,
                1.917346464706755E-002,
                3.799714764789616E-002,
                7.123562049953998E-002,
                7.123562049953998E-002,
                3.799714764789616E-002,
                2.989084475992800E-002,
                4.782535161588505E-002,
                2.989084475992800E-002,
                6.038050853208200E-003,
                6.038050853208200E-003]
    sum = 0
    for i in range(0,14):
        x = x1*(1-x_quad[i,0] - x_quad[i,1]) +x2*x_quad[i,0] + x3*x_quad[i,1]
        y = y1*(1-x_quad[i,0] - x_quad[i,1]) +y2*x_quad[i,0] + y3*x_quad[i,1]
        sum += function(x,y) * weight_quad[i]
    sum*= abs(det(x1,y1,x2,y2,x3,y3))
    return sum

# %%



